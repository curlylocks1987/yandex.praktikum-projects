# Моделирование оттока для сети фитнес-центров.

Яндекс.Практикум, Анализ Данных, Проект 9: ML, sklearn, классификация: logistic regression, random forest classifier; кластеризация: distance matrix, dendrogram, K-Means.

__Attention:__ Иногда GitHub капризничает и не открывает файлы .ipynb, но проект всегда можно посмотреть в Jupyter NBViewer по ссылке: https://nbviewer.jupyter.org/github/curlylocks1987/yandex.praktikum-projects/blob/main/ML_Churn_model_for_gym_%28project_9%29/Project_9_ML.ipynba


## Данные

- `'Churn'` — факт оттока в текущем месяце;
- Текущие поля в датасете:
    - Данные клиента за предыдущий до проверки факта оттока месяц:
        - `'gender'` — пол;
        - `'Near_Location'` — проживание или работа в районе, где находится фитнес-центр;
        - `'Partner'` — сотрудник компании-партнёра клуба (сотрудничество с компаниями, чьи сотрудники могут получать скидки на абонемент — в таком случае фитнес-центр хранит информацию о работодателе клиента);
        - `'Promo_friends'` — факт первоначальной записи в рамках акции «приведи друга» (использовал промо-код от знакомого при оплате первого абонемента);
        - `'Phone'` — наличие контактного телефона;
        - `'Age'` — возраст;
        - `'Lifetime'` — время с момента первого обращения в фитнес-центр (в месяцах).
- Информация на основе журнала посещений, покупок и информация о текущем статусе абонемента клиента:
    - `'Contract_period'` — длительность текущего действующего абонемента (месяц, 3 месяца, 6 месяцев, год);
    - `'Month_to_end_contract'` — срок до окончания текущего действующего абонемента (в месяцах);
    - `'Group_visits'` — факт посещения групповых занятий;
    - `'Avg_class_frequency_total'` — средняя частота посещений в неделю за все время с начала действия абонемента;
    - `'Avg_class_frequency_current_month'` — средняя частота посещений в неделю за предыдущий месяц;
    - `'Avg_additional_charges_total'` — суммарная выручка от других услуг фитнес-центра: кафе, спорт-товары, косметический и массажный салон.

## Задача

М- научиться прогнозировать вероятность оттока (на уровне следующего месяца) для каждого клиента;
- сформировать типичные портреты клиентов: выделить несколько наиболее ярких групп и охарактеризовать их основные свойства;
- проанализировать основные признаки, наиболее сильно влияющие на отток;
- сформулировать основные выводы и разработать рекомендации по повышению качества работы с клиентами:
    1. выделить целевые группы клиентов;
    2. предложить меры по снижению оттока;
    3. определить другие особенности взаимодействия с клиентами.

## Используемые библиотеки
*pandas*, *seaborn*, *Matplotlib*, *numpy*, *sklearn*, *skipy.cluster.hierarchy*

## Основные этапы работы

- Загрузили и обработали данные, заменили названия столбцов.

- В ходе EDA расчитали средние и стандартные отклонения признаков, посмотрели на распределения, построили матрицу корреляции, выявили и убрали из рассмотрения заведомо линейно зависимые признаки. В итоге осталось 11 значимых признаков. 

- Разбили выборку в соотношении 80:20 на обучающую и валидационную. Обучили две модели: логистическую регрессию и случайный лес. По метрикам (accuracy, precision, recall) поняли, что логистическая регрессия лучше. Наибольшее влиятние на отток в данной модели оказывают признаки age, lifetime и contract_period.

- Осуществили кластеризацию, сначала при помощи дерева расстояний, а затем при помощи алгоритма K-Means. В итоге разбили признаки на 5 кластеров, которые однозначно дифференцируются по убыванию среднего оттока. Основные признаки, отрицательно коррелирующие с процентом оттока те же, что и в логистической регрессии: age, lifetime, contract_period. К ним можно также добавить доп. расходы, посещение групповых занятий и среднее число посещений в неделю.

## Основные выводы

Как модель логистической регрессии, так и алгоритм кластеризации K-Means показывают сильное влияние признаков __возраст, lifetime, продолжительность контракта__ на отток. Чем они выше, тем отток меньше.

В рамках кластеризации выделились 5 групп пользователей:

- __Кластеры 1 и 4__ похожи, средний отток в них составляет не меньше 40%. Это много. Всего в этих кластерах 44% нашей выборки. Для этих кластеров характерен средний возраст ниже 29 лет, средний lifetime меньше 3 месяцев, средний период контракта меньше 3 месяцев.

- __Кластеры 0 и 3__ - пограничные. Отток в них 27% и 13%, возраст 29-30 лет, lifetime 3-4 месяца, период контракта 5-7 месяцев. Вместе эти кластеры составляют около 35% выборки.

- __Кластер 2__ - "золотой фонд". Отток в нем всего 1%. Возраст старше 30, lifetime 5-6 месяцев, контракт 7 месяцев. Для данной выборки в этот кластер попали 21% клиентов.

При переходе __рубежа 30 лет, lifetime - 5 месяцев, контракт - 7 месяцев, отток резко снижается__.

Из менее значимых признаков, которые все же стоит мониторить менеджерам, можно отметить сумму дополнительных расходов, частоту посещений в неделю, посещение групповых занятий.

